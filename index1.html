<!DOCTYPE html>
<html lang="th">
<head>
  <!-- Required meta tags -->
<meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ลงทะเบียนข้อมูลกำลังพล ร้อย.ปชด.ที่ 1</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/png" sizes="32x32" href="./โลโก้กองร้อยไม่มีที่32x32.png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <link href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css" rel="stylesheet">
</head>
<!--div class="container d-flex align-items-center justify-content-center min-vh-100"-->
<body>
  <div class="wrapper">
    <div class="title">
      <i class="fas fa-chalkboard-teacher"></i> ลงทะเบียนข้อมูลกำลังพล
      <p>ร้อย.ปชด.ที่ 1</p>
      <p>ประจำปีงบประมาณ 2569</p>
    </div>
  <form class="form" id="myForm">
    <!-- novalidate -->
    <div class="inputfield">
      <label>ยศ</label>
      <select type="text" class="custom_select" id="ยศ" name="ยศ" required>
        <option selected disabled value="">เลือกยศ</option>
        <option value="ร.อ.">ร.อ.</option>
        <option value="ร.ท.">ร.ท.</option>
        <option value="ร.ต.">ร.ต.</option>
        <option value="จ.ส.อ.">จ.ส.อ.</option>
        <option value="จ.ส.ท.">จ.ส.ท.</option>
        <option value="จ.ส.ต.">จ.ส.ต.</option>
        <option value="ส.อ.">ส.อ.</option>
        <option value="ส.ท.">ส.ท.</option>
        <option value="ส.ต.">ส.ต.</option>
        <option value="พลฯ">พลฯ</option>
      </select>
    </div>
    <div class="inputfield">
      <label>ชื่อ</label>
      <input type="text" class="input" id="ชื่อ" name="ชื่อ" placeholder="ยอดรัก" required>
    </div>
    <div class="inputfield">
      <label>นามสกุล</label>
      <input type="text" class="input" id="สกุล" name="สกุล" placeholder="ทหารไทย" required>
    </div>
    <div class="inputfield">
      <label>ฐานปฏิบัติการ</label>
      <select type="text" class="custom_select" id="ฐานปฏิบัติการ" name="ฐานปฏิบัติการ" required>
        <option selected disabled value="">เลือกฐานปฏิบัติการ</option>
        <option value="บก.ร้อย.และ มว.ปชด.2 ฐป.โรงเรียนมาลาศีตะจิตต์">บก.ร้อย.และ มว.ปชด.2 ฐป.โรงเรียนมาลาศีตะจิตต์
        </option>
        <option value="มว.ปชด.1 ฐป.ฟาร์มตัวอย่าง">มว.ปชด.1 ฐป.ฟาร์มตัวอย่าง</option>
        <option value="มว.ปชด.3 ฐป.ร่วมบ้านดีดะ">มว.ปชด.3 ฐป.ร่วมบ้านดีดะ</option>
      </select>
    </div>
    <div class="inputfield">
      <label>ตำแหน่งที่ตั้งปกติ</label>
      <input type="text" class="input" id="ตำแหน่งที่ตั้งปกติ" name="ตำแหน่งที่ตั้งปกติ"
        placeholder="เช่น ผบ.หมู่ หมู่ ปล.มว.ปล.ร้อย.อวบ.ร.152 พัน.1">
    </div>
    <div class="inputfield">
      <label>สังกัดปกติ</label>
      <select type="text" class="custom_select" id="สังกัดปกติ" name="สังกัดปกติ" required>
        <option selected disabled value="">เลือกสังกัดปกติ</option>
        <option value="พล.ร.15">พล.ร.15</option>
        <option value="ร.152">ร.152</option>
        <option value="ร.152 พัน.1">ร.152 พัน.1</option>
      </select>
    </div>
    <div class="inputfield">
      <label>สังกัดกองร้อยปกติ</label>
      <select type="text" class="custom_select" id="สังกัดกองร้อยปกติ" name="สังกัดกองร้อยปกติ" required>
        <option selected disabled value="">เลือกสังกัดกองร้อยปกติ</option>
        <option value="ร้อย.บก.">ร้อย.บก.</option>
        <option value="ร้อย.1">ร้อย.1</option>
        <option value="ร้อย.2">ร้อย.2</option>
        <option value="ร้อย.3">ร้อย.3</option>
      </select>
    </div>
    <div class="inputfield">
      <label>หมายเลขประจำตัวประชาชน</label>
      <input type="text" class="input" id="หมายเลขประจำตัวประชาชน" name="หมายเลขประจำตัวประชาชน"
        placeholder="x-xxxx-xxxxx-xx-x" onkeyup="autoTab(this)" minlength="13" maxlength="17" required>
    </div>
    <div class="inputfield">
      <label>หมายเลขทหาร 10 หลัก</label>
      <input type="text" class="input" id="หมายเลขทหาร10หลัก" name="หมายเลขทหาร10หลัก" placeholder="xxxxxxxxxx"
        minlength="10" maxlength="10" required>
    </div>
    <div class="inputfield">
      <label>หมายเลขปืน</label>
      <input type="text" class="input" id="หมายเลขปืน" name="หมายเลขปืน" placeholder="xxxxxxx" minlength="7"
        maxlength="7" required>
    </div>
    <div class="inputfield">
      <label>กรุ๊ปเลือด</label>
      <select type="text" id="กรุ๊ปเลือด" name="กรุ๊ปเลือด" class="custom_select" required>
        <option selected disabled value="">เลือกกรุ๊ป</option>
        <option value="A">A</option>
        <option value="B">B</option>
        <option value="AB">AB</option>
        <option value="O">O</option>
      </select>
    </div>
    <div class="inputfield">
      <label>ภูมิลำเนา (บ้านเกิด)</label>
      <textarea class="textarea" id="ที่อยู่ปัจจุบัน" name="ที่อยู่ปัจจุบัน"
        placeholder="เช่น 999 ม.9 ต.ควนลัง อ.หาดใหญ่ จ.สงขลา 90110" required></textarea>
    </div>
    <div class="inputfield">
      <label>หมายเลขโทรศัพท์</label>
      <input type="text" class="input" id="หมายเลขโทรศัพท์" name="หมายเลขโทรศัพท์" placeholder="xxx-xxxxxxx"
        onkeyup="autoPhone(this)" minlength="10" maxlength="11" required>
    </div>
<!--     <div class="inputfield">
      <label>ฉีดวัคซีนโควิด เข็มที่ 1</label>
      <input type="date" class="form-control" id="ฉีดวัคซีนโควิดเข็มที่1" name="ฉีดวัคซีนโควิดเข็มที่1" />
    </div>
    <div class="inputfield">
      <label>ฉีดวัคซีนโควิด เข็มที่ 2</label>
      <input type="date" class="form-control" id="ฉีดวัคซีนโควิดเข็มที่2" name="ฉีดวัคซีนโควิดเข็มที่2">
    </div>
    <div class="inputfield">
      <label>ฉีดวัคซีนโควิด เข็มที่ 3</label>
      <input type="date" class="form-control" id="ฉีดวัคซีนโควิดเข็มที่3" name="ฉีดวัคซีนโควิดเข็มที่3">
    </div>
    <div class="inputfield">
      <label>ฉีดวัคซีนโควิด เข็มที่ 4</label>
      <input type="date" class="form-control" id="ฉีดวัคซีนโควิดเข็มที่4" name="ฉีดวัคซีนโควิดเข็มที่4">
    </div> -->
    <div class="inputfield">
      <label>ศาสนา</label>
      <select type="text" id="ศาสนา" name="ศาสนา" class="custom_select" required>
        <option selected disabled value="">เลือกศาสนา</option>
        <option value="พุทธ">พุทธ</option>
        <option value="อิสลาม">อิสลาม</option>
      </select>
    </div>
    <div class="inputfield">
      <label>พ.ส.ร. ครั้งที่ 1 นายทหาร/นายสิบ</label>
      <input type="date" class="form-control" id="ได้รับเงินเพิ่มพิเศษสำหรับการสู้รบครั้งที่1"
        name="ได้รับเงินเพิ่มพิเศษสำหรับการสู้รบครั้งที่1">
    </div>
    <div class="inputfield">
      <label>พ.ส.ร. ครั้งที่ 2 นายทหาร/นายสิบ</label>
      <input type="date" class="form-control" id="ได้รับเงินเพิ่มพิเศษสำหรับการสู้รบครั้งที่2"
        name="ได้รับเงินเพิ่มพิเศษสำหรับการสู้รบครั้งที่2">
    </div>
    <div class="inputfield">
      <label>พ.ส.ร. ครั้งที่ 3 นายทหาร/นายสิบ</label>
      <input type="date" class="form-control" id="ได้รับเงินเพิ่มพิเศษสำหรับการสู้รบครั้งที่3"
        name="ได้รับเงินเพิ่มพิเศษสำหรับการสู้รบครั้งที่3">
    </div>
    <div class="inputfield">
      <label>พ.ส.ร. ครั้งที่ 4 นายทหาร/นายสิบ</label>
      <input type="date" class="form-control" id="ได้รับเงินเพิ่มพิเศษสำหรับการสู้รบครั้งที่4"
        name="ได้รับเงินเพิ่มพิเศษสำหรับการสู้รบครั้งที่4">
    </div>
    <div class="inputfield">
      <label>บุคคลสนิท</label>
      <input type="text" class="input" id="บุคคลสนิท" name="บุคคลสนิท" placeholder="นายรักรบ ทหารไทย" required>
    </div>
    <div class="inputfield">
      <label>ความสัมพันธ์ บุคคลสนิท</label>
      <select type="text" id="ความสัมพันธ์" name="ความสัมพันธ์" class="custom_select" required>
        <option selected disabled value="">เลือกความสัมพันธ์</option>
        <option value="บิดา">บิดา</option>
        <option value="มารดา">มารดา</option>
        <option value="พี่">พี่</option>
        <option value="น้อง">น้อง</option>
        <option value="ปู่">ปู่</option>
        <option value="ย่า">ย่า</option>
        <option value="ตา">ตา</option>
        <option value="ยาย">ยาย</option>
        <option value="คู่สมรส">คู่สมรส</option>
        <option value="เพื่อนร่วมงาน">เพื่อนร่วมงาน</option>
      </select>
    </div>
    <div class="inputfield">
      <label>เบอร์โทรศัพท์
        บุคคลสนิท</label>
      <input type="text" class="input" id="เบอร์โทรศัพท์บุคคลสนิท" name="เบอร์โทรศัพท์บุคคลสนิท"
        placeholder="xxx-xxxxxxx" onkeyup="autoPhone(this)" minlength="10" maxlength="11" required>
    </div>
    <div class="inputfield">
      <label>วัน/เดือน/ปีเกิด ของกำลังพล</label>
      <input type="date" class="form-control" id="วันเดือนปีเกิดของกำลังพล" name="วันเดือนปีเกิดของกำลังพล" required>
    </div>
    <div class="inputfield">
      <label>อายุ ของกำลังพล</label>
      <input type="text" class="input" id="อายุของกำลังพล" name="อายุของกำลังพล" placeholder="xx" minlength="2"
        maxlength="2" required>
    </div>
    <!-- สร้าง Checkbox โดยให้ชื่อว่า my_checkbox  
    <div class="checkbox"><input type="checkbox" name="my_checkbox" value="" required />&nbsp;ยอมรับข้อกำหนดและเงื่อนไข
      </p> -->
    <!-- </div> -->
    <!-- สร้าง กดปุ่มนี้เพื่อบันทึกข้อมูล  -->
    <div class="inputfield">
      <input class="btn" type="submit" id="btn1" value="กดปุ่มนี้เพื่อบันทึกข้อมูล">
      <!-- <button class="btn btn-primary" type="submit" style="display:none" disabled id="btn2">
         <span class="spinner-border spinner-border-sm" role="status" ></span>
         กำลังบันทึกข้อมูล...
          </button> -->
    </div>
    <!-- สร้าง กดปุ่มนี้เพื่อบันทึกข้อมูล  -->
    <div class="text"><img src=".\ทหาร-การ์ตูน.png" width="18" height="30"> พัฒนาโดย นายสิบท่องเที่ยว <img
        src=".\ทหาร-การ์ตูน.png" width="18" height="30">
      <p>" ร้อย.ปชด.ที่ 1 บก.ควบคุม สุริโยทัย "</p>
    </div>
    <!-- Script Section -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- 🔊 เพิ่มไฟล์เสียง -->
<audio id="successSound" src="https://assets.mixkit.co/sfx/preview/mixkit-clear-announce-tones-2861.mp3"></audio>
<audio id="errorSound" src="https://assets.mixkit.co/sfx/preview/mixkit-system-beep-buzzer-fail-2964.mp3"></audio>

<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbzzS0W_vc_00ymy2RAF5DKgzwKb02p6J__ZX20FXS0gzOQHB4V6sX1u_M9TQHezWBzl/exec';
  const form = document.getElementById('myForm');
  const successSound = document.getElementById("successSound");
  const errorSound = document.getElementById("errorSound");

  // 📝 mapping field → label
  const fieldLabels = {
    "ยศ": "🎖️ ยศ",
    "ชื่อ": "👤 ชื่อ",
    "สกุล": "👥 นามสกุล",
    "ฐานปฏิบัติการ": "🏕️ ฐานปฏิบัติการ",
    "ตำแหน่งที่ตั้งปกติ": "📍 ตำแหน่งที่ตั้งปกติ",
    "สังกัดปกติ": "🏛️ สังกัดปกติ",
    "สังกัดกองร้อยปกติ": "🪖 สังกัดกองร้อยปกติ",
    "หมายเลขประจำตัวประชาชน": "🆔 เลขประจำตัวประชาชน",
    "หมายเลขทหาร10หลัก": "🔢 หมายเลขทหาร 10 หลัก",
    "หมายเลขปืน": "🔫 หมายเลขปืน",
    "กรุ๊ปเลือด": "🩸 กรุ๊ปเลือด",
    "ที่อยู่ปัจจุบัน": "🏠 ภูมิลำเนา (บ้านเกิด)",
    "หมายเลขโทรศัพท์": "📞 เบอร์โทรศัพท์",
    "ศาสนา": "🙏 ศาสนา",
    "ได้รับเงินเพิ่มพิเศษสำหรับการสู้รบครั้งที่1": "💵 พ.ส.ร. ครั้งที่ 1",
    "ได้รับเงินเพิ่มพิเศษสำหรับการสู้รบครั้งที่2": "💵 พ.ส.ร. ครั้งที่ 2",
    "ได้รับเงินเพิ่มพิเศษสำหรับการสู้รบครั้งที่3": "💵 พ.ส.ร. ครั้งที่ 3",
    "ได้รับเงินเพิ่มพิเศษสำหรับการสู้รบครั้งที่4": "💵 พ.ส.ร. ครั้งที่ 4",
    "บุคคลสนิท": "👨‍👩‍👧‍👦 บุคคลสนิท",
    "ความสัมพันธ์": "🤝 ความสัมพันธ์",
    "เบอร์โทรศัพท์บุคคลสนิท": "📱 เบอร์โทรบุคคลสนิท",
    "วันเดือนปีเกิดของกำลังพล": "🎂 วัน/เดือน/ปีเกิด",
    "อายุของกำลังพล": "⌛ อายุ"
  };

  form.addEventListener('submit', e => {
    e.preventDefault();

    const formData = new FormData(form);

    // ✅ แสดง preview ก่อนบันทึก
    let reviewTable = `<table class="table table-bordered table-striped text-start">
      <thead class="table-warning">
        <tr><th>หัวข้อ</th><th>ข้อมูลที่กรอก</th></tr>
      </thead><tbody>`;

    formData.forEach((value, key) => {
      if (value.trim() !== "") {
        const label = fieldLabels[key] || key;
        reviewTable += `<tr><td><b>${label}</b></td><td>${value}</td></tr>`;
      }
    });

    reviewTable += `</tbody></table>`;

    Swal.fire({
      title: '📋 ตรวจสอบข้อมูลก่อนบันทึก',
      html: reviewTable,
      width: 'auto',
      icon: 'info',
      showCancelButton: true,
      confirmButtonText: '✅ ยืนยันบันทึก',
      cancelButtonText: '❌ กลับไปแก้ไข',
      reverseButtons: true,
    }).then((result) => {
      if (result.isConfirmed) {
        Swal.fire({
          title: '⏳ กำลังบันทึกข้อมูล...',
          html: '<div class="progress"><div class="progress-bar progress-bar-striped progress-bar-animated" style="width:100%"></div></div>',
          allowOutsideClick: false,
          showConfirmButton: false,
          didOpen: () => Swal.showLoading()
        });

        fetch(scriptURL, { method: 'POST', body: formData })
          .then(response => {
            Swal.fire({
              icon: 'success',
              title: '✅ บันทึกข้อมูลเรียบร้อย',
              confirmButtonText: '💂 รับทราบ 💂'
            });
            successSound.play(); // 🔊 success
            form.reset();
          })
          .catch(error => {
            Swal.fire({
              icon: 'error',
              title: '❌ เกิดข้อผิดพลาด',
              text: error.message
            });
            errorSound.play(); // 🔊 error
          });
      }
    });
  });
    // ฟังก์ชันสำหรับเพิ่มขีดกลางในหมายเลขประจำตัวประชาชนและหมายเลขโทรศัพท์
    function autoTab(obj) {
      var pattern = "_-____-_____-_-__";
      var pattern_ex = "-";
      var returnText = "";
      var obj_l = obj.value.length;
      var obj_l2 = obj_l - 1;
      for (let i = 0; i < pattern.length; i++) {
        if (obj_l2 == i && pattern.charAt(i + 1) == pattern_ex) {
          returnText += obj.value + pattern_ex;
          obj.value = returnText;
        }
      }
      if (obj_l >= pattern.length) {
        obj.value = obj.value.substr(0, pattern.length);
      }
    }

    function autoPhone(obj) {
      var pattern = "___-_______";
      var pattern_ex = "-";
      var returnText = "";
      var obj_l = obj.value.length;
      var obj_l2 = obj_l - 1;
      for (let i = 0; i < pattern.length; i++) {
        if (obj_l2 == i && pattern.charAt(i + 1) == pattern_ex) {
          returnText += obj.value + pattern_ex;
          obj.value = returnText;
        }
      }
      if (obj_l >= pattern.length) {
        obj.value = obj.value.substr(0, pattern.length);
      }
    }
  </script>
</body>
</html>
